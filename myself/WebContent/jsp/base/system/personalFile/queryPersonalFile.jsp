<%@ page language="java" contentType="text/html; charset=UTF-8"%><%@ include file="/jsp/base/core/taglibs.jsp"%><html>	<head>		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">		<script type="text/javascript">			var grid,quer;				        //表格	        $(function (){	        	init_page();	        	var pageSize = '${pageSize}';	            grid = $("#maingrid").ligerGrid({	                height:'99%',enabledSort:false,	                columns: [	                	{ display: '档案编号', name: 'ARCHIVE_ID', align: 'left', width: 150  },	                	{ display: '用户名称', name: 'USER_NAME', align: 'left', width: 150 },	                	{ display: '登录名', name: 'LOGON_NAME', align: 'left', width: 150 },	                	{ display: '职位', name: 'POSITION_NAME', align: 'left', width: 250 },	                	{ display: '性别', name: 'SEX', align: 'left', width: 100 },	                	{ display: '操作', isSort: false, width: 100, render: function (rowdata, rowindex, value){                    		return "<a href='#' onclick=\"showPersonalFile('"+rowdata.ARCHIVE_ID+"')\">档案维护</a>";                		}                		}	                ], 	                url:"${ctx}/PersonalFileAction.action?method=getPersonalFileJSON",  	                pageSize:pageSize ,rownumbers:true,	                toolbar: { items: [	                	{ id:'1', text: '查询', click: itemclick, icon: 'search2' },	                	{ line: true },	                	{ id:'2', text: '增加', click: itemclick, icon: 'add' },	                	{ line: true },	                	{ id:'4', text: '删除', click: itemclick, icon: 'delete' },	                	{ line: true },	                	{ id:'5', text: '功能说明', click: itemclick, icon: '' }	                ]}	            });	            	            $("#pageloading").hide();	        });	        	        function showPersonalFile(archiveId){				$.ligerDialog.open({ title:'个人档案',height: 700,width: 800, 					url: '${ctx}/PersonalFileAction.action?method=mainShowPersonalFile&archiveId='+archiveId });			}			function itemclick(item){				var id = item.id;	            var text = item.text;	            if(id == '1'){		        	query=ligerDialog_open(text,$("#targetQuery"),"queryOK","","");	            }else if(id == '2'){	            	liger.get("userName").setValue("");	            	liger.get("positionName").setValue("");	            	liger.get("birthday").setValue("");	            	liger.get("natonalName").setValue("");	            	liger.get("tel").setValue("");	            	liger.get("homeTel").setValue("");	            	liger.get("homeAddr").setValue("");	            	liger.get("jobTitle").setValue("");	            	liger.get("orgId").setValue("");					liger.get("sex").setValue("女");					liger.get("sex").setText("女");					liger.get("zzmm").setValue("非团员");					liger.get("zzmm").setText("非团员");	            	ligerDialog_open(text,$("#target"),"addOK","","450");	            }else if(id == '4'){	            	var row = grid.getSelectedRow();            		if (!row) { warn_alert('请选择行'); return; }            		if (row.USER_ID!=null) { warn_alert('登录用户的档案信息不可删除'); return; }            		            		$.ligerDialog.confirm('是否删除用户档案？', function (isOk) {            			if(isOk){		            		$.post("${ctx}/PersonalFileAction.action?method=deletePersonalFile&anticache="									+ Math.floor(Math.random() * 10000), {								id : row.ARCHIVE_ID							}, function(info) {								if (info.info == undefined) {									info = eval("(" + info + ")");								}								if (info.info == 'ok') {									grid.reload();								} else {									error_alert("${ctx}","删除用户档案失败","编号："+row.ARCHIVE_ID);								}							});						}            		});            			            }else if(id == '5'){	            	showMenuDesc(text);	            }	        }	        //查询点击确定按钮			function queryOK(item, dialog){				var gridManager = $("#maingrid").ligerGetGridManager();        		if (!gridManager) return;   				gridManager.setOptions({parms:[{name : "userName",   					value:$("#queryUserName").val()}]});   				gridManager.loadData(true);   				dialog.hidden();			}			//新增点击确定按钮			function addOK(item, dialog){				var param = {						userName: liger.get("userName").getValue(),						positionName: liger.get("positionName").getValue(),						birthday: $("#birthday").val(),						natonalName: liger.get("natonalName").getValue(),						sex: liger.get("sex").getValue(),						tel: liger.get("tel").getValue(),						zzmm: liger.get("zzmm").getValue(),						homeTel: liger.get("homeTel").getValue(),						homeAddr: liger.get("homeAddr").getValue(),						jobTitle: liger.get("jobTitle").getValue(),						orgId: liger.get("orgId").getValue()				};				$.post("${ctx }/PersonalFileAction.action?method=savePersonalFileAdd&anticache="						+ Math.floor(Math.random() * 10000), param, function(info) {					if (info.info == undefined) {						info = eval("(" + info + ")");					}					if (info.info == 'ok') {	            		grid.reload();	            		dialog.hidden();					} else {						error_alert("${ctx}","新增档案失败",mapToString(param));					}				});			}								</script>	</head>	<body style="overflow-x:hidden; padding:2px;">		<div class="l-loading" style="display:block" id="pageloading"></div>    	<div id="maingrid"></div>    	<!-- 查询 -->    	<div id="targetQuery" class="self-form" style="display:none;">        	<table class="self-table">    			<tr>    				<td width="90px">用户名称</td>    				<td><input type="text" id="queryUserName" value=""></td>    			</tr>    		</table>    	</div>    	<!-- 修改新增 -->    	<div id="target" class="self-form" style="display:none;">        	<table class="self-table">    			<tr >    				<td width="90px">姓名</td>    				<td><input type="text" id="userName" name="userName" value=""></td>    			</tr>    			<tr>    				<td>职位</td>    				<td><input type="text" id="positionName" name="positionName" value=""></td>    			</tr>    			<tr>    				<td>出生日期</td>    				<td><input type="text" id="birthday" name="birthday" ltype="date" value=""></td>    			</tr>    			<tr>    				<td>性别</td>    				<td>    					<select id="sex" name="sex">    						<option value="女" selected>女    						<option value="男">男    					</select>    				</td>    			</tr>    			<tr>    				<td>民族</td>    				<td><input type="text" id="natonalName" name="natonalName" value=""></td>    			</tr>    			<tr>    				<td>个人电话</td>    				<td><input type="text" id="tel" name="tel" ltype="int" value=""></td>    			</tr>    			<tr>    				<td>家庭电话</td>    				<td><input type="text" id="homeTel" name="homeTel" ltype="int" value=""></td>    			</tr>    			<tr>    				<td>家庭地址</td>    				<td><input type="text" id="homeAddr" name="homeAddr" value=""></td>    			</tr>    			<tr>    				<td>职称</td>    				<td><input type="text" id="jobTitle" name="jobTitle" value=""></td>    			</tr>    			<tr>    				<td>部门</td>    				<td><input type="text" id="orgId" name="orgId" value=""></td>    			</tr>    			<tr>    				<td>政治面貌</td>    				<td>    					<select id="zzmm" name="zzmm">    						<option value="非团员" selected>非团员    						<option value="团员">团员    					</select>    				</td>    			</tr>    		</table>    	</div>    		</body></html>