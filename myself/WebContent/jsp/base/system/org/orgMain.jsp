<%@ page language="java" contentType="text/html; charset=UTF-8"%><%@ include file="/jsp/base/core/taglibs.jsp"%><html>	<head>		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">		<link href="${ctx }/style/main/css/main.css" rel="stylesheet" type="text/css">		<script type="text/javascript">						var tab = null;			var tree = null;			var menu = null; //右键菜单			var accordion = null;			var actionNodeID = null;			var ownActionNodeID = null;			$(function() {				menu = $.ligerMenu({ top: 100, left: 100, width: 120, items:		            [		            {id:"1", text: '增加同级机构',  URL:'/OrgAction.action?method=gotoAddOrg', click: itemclick, icon: '' },		            { line: true },		            {id:"2", text: '增加下级机构', URL:'/OrgAction.action?method=gotoAddOrg', click: itemclick },		            { line: true },		            {id:"3", text: '修改机构', URL:'/OrgAction.action?method=gotoEditOrg', click: itemclick },		            { line: true },		            {id:"4", text: '删除机构', click: deleteclick }		            ]				});				//布局				$("#layout1").ligerLayout({					leftWidth : 220,					height : '100%',					space : 4,					onHeightChanged : f_heightChanged				});				var height = $(".l-layout-center").height();				//Tab				$("#framecenter").ligerTab({height : height});				//面板				$("#accordion1").ligerAccordion({					height : height - 24,					speed : null				});								//设置当鼠标移动到菜单上时和鼠标移出菜单时 菜单的样式				$(".l-link").hover(function() {					$(this).addClass("l-link-over");				}, function() {					$(this).removeClass("l-link-over");				});								//树				$("#tree1").ligerTree({				    url : '${ctx}/OrgAction.action?method=queryLeftOrg',				    checkbox : false,				    slide: false,				    nodeWidth:200,				    idFieldName : 'ID',				    parentIDFieldName : 'PID',				    textFieldName : 'TEXT',				    onSelect: function (node){				    	if(node.data.ID != '1')				    	f_addTab("org3", "修改机构", '${ctx }/OrgAction.action?method=gotoEditOrg&orgId='+node.data.ID);				    },				    onContextmenu: function (node, e){				    	actionNodeID = node.data.ID;				    	ownActionNodeID = node.data.PID;				    	if(actionNodeID == '1'){				    		menu.setDisabled(1);				    		menu.setDisabled(3);				    		menu.setDisabled(4);				    	}else{				    		menu.setEnabled(1);				    		menu.setEnabled(3);				    		menu.setEnabled(4);				    	}				    	menu.show({ top: e.pageY, left: e.pageX });				    	return false;				    }				});								tab = $("#framecenter").ligerGetTabManager();				accordion = $("#accordion1").ligerGetAccordionManager();				tree = $("#tree1").ligerGetTreeManager();				$("#pageloading").hide();							});			function itemclick(item, i){				//f_overrideTab(actionNodeID, item.text, '${ctx }'+item.URL);				var id;				if(item.id==1){					//增加同级传过去的应该是上级编号					id = ownActionNodeID;				}else{					id = actionNodeID;				}				f_addTab("org"+item.id, item.text, '${ctx }'+item.URL+'&orgId='+id);            }            function deleteclick(){            	$.ligerDialog.confirm('是否删除机构？', function (isOk) {            		if(isOk){		            	$.post("${ctx}/OrgAction.action?method=deleteOrg",{							orgId: actionNodeID						},function(info){							if (info.info == undefined) {								info = eval("(" + info + ")");							}							if(info.info=='ok'){								refresh();								$.ligerDialog.success('删除机构成功');							}else{								error_alert("${ctx}","删除机构失败","orgId:"+actionNodeID);							}						});					}				});            }			//调整tab在高度			function f_heightChanged(options) {				if (tab)					tab.addHeight(options.diff);				if (accordion && options.middleHeight - 24 > 0)					accordion.setHeight(options.middleHeight - 24);			}			//新增一个tab窗口			function f_addTab(tabid, text, url) {				if(tab.isTabItemExist(tabid)){					tab.removeTabItem(tabid);				}				tab.addTabItem({					tabid : tabid,					text : text,					url : url				});			}						function refresh(){				tree.clear();				tree.loadData(null,'OrgAction.action?method=queryLeftOrg');			}		</script>	</head>	<body style="padding:0px;background:#EAEEF5;">  		<div id="pageloading"></div>  		<div id="layout1" style="width:99.2%; margin:0 auto; margin-top:4px; "> 	    	<div position="left"  title="点击鼠标右键" id="accordion1">	        	<ul id="tree1" style="margin-top:3px;">	     	</div>	     	<div position="center" id="framecenter"></div> 	 	</div>	</body></html>