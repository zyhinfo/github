<%@ page language="java" contentType="text/html; charset=UTF-8"%><%@ include file="/jsp/base/core/taglibs.jsp"%><!DOCTYPE html><html>	<head>		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">		<script type="text/javascript">			var grid,query;	        //表格	        $(function (){	        	init_page();	            grid = $("#maingrid").ligerGrid({	                height:'99%',enabledSort:false,usePager:false,rownumbers:true,	                columns: [	                	{ display: '属性编号', name: 'ATTR_ID', align: 'left', width: 150  },	                	{ display: '属性名称', name: 'ATTR_NAME', align: 'left', width: 150 },	                	{ display: '属性描述', name: 'ATTR_DESC', align: 'left', width: 250 },	                	{ display: '属性类型', name: 'ATTR_TYPE', width: 100, 	                		render: function (rowdata, rowindex, value){			                    if (value == 'NUMBER'){return "数字"}			                    else {return "文本";}			                }		                },	                	{ display: '属性长度', name: 'ATTR_LEN', width: 100 },	                	{ display: '显示顺序', name: 'SEQ_NUM', width: 100 }	                ], 	                url:"${ctx}/AttrAction.action?method=getAttrJSON",  	                toolbar: { items: [	                	{ id:'1', text: '查询', click: itemclick, icon: 'search2' },	                	{ line: true },	                	{ id:'2', text: '增加', click: itemclick, icon: 'add' },	                	{ line: true },	                	{ id:'3', text: '修改', click: itemclick, icon: 'modify' },	                	{ line: true },	                	{ id:'4', text: '删除', click: itemclick, icon: 'delete' },	                	{ line: true },	                	{ id:'5', text: '功能说明', click: itemclick, icon: '' }	                ]}	            });	            $("#pageloading").hide();	            	        });	        			function itemclick(item){	            var id = item.id;	            var text = item.text;	            if(id == '1'){		        	query=ligerDialog_open(text,$("#targetQuery"),"queryOK","","");	            }else if(id == '2'){	            	liger.get("attrName").setValue("");	            	liger.get("attrDesc").setValue("");	            	liger.get("attrType").setValue("");	            	liger.get("attrLen").setValue("");	            	liger.get("seqNum").setValue("");						            	ligerDialog_open(text,$("#target"),"addOK","","260");	            }else if(id == '3'){	            	var row = grid.getSelectedRow();            		if (!row) { warn_alert('请选择行'); return; }            		$("#attrId").val(row.ATTR_ID);            		liger.get("attrName").setValue(row.ATTR_NAME);            		liger.get("attrDesc").setValue(row.ATTR_DESC);            		liger.get("attrType").setValue(row.ATTR_TYPE);            		var attrTypeDesc = "文字"            		if(row.ATTR_TYPE == "NUMBER") attrTypeDesc = "数字";            		liger.get("attrType").setText(attrTypeDesc);            		liger.get("attrLen").setValue(row.ATTR_LEN);            		liger.get("seqNum").setValue(row.SEQ_NUM);            		            		ligerDialog_open(text,$("#target"),"editOK","","260");	            }else if(id == '4'){	            	var row = grid.getSelectedRow();            		if (!row) { warn_alert('请选择行'); return; }            		$.ligerDialog.confirm('是否删除属性？', function (isOk) {            			if(isOk){            				$.post("${ctx}/AttrAction.action?method=deleteAttr&anticache="									+ Math.floor(Math.random() * 10000), {								id : row.ATTR_ID							}, function(info) {								if (info.info == undefined) {									info = eval("(" + info + ")");								}								if (info.info == 'ok') {									grid.reload();								} else {									error_alert("${ctx}","删除属性失败","编号："+row.ATTR_ID);								}							});            			}            			            		});	            }else if(id == '5'){	            	showMenuDesc(text);	            }	        }	       //查询点击确定按钮			function queryOK(item, dialog){				var gridManager = $("#maingrid").ligerGetGridManager();        		if (!gridManager) return;   				gridManager.setOptions({parms:[   					{name : "attrName",value:liger.get("queryAttrName").getValue()},   					{name : "attrDesc",value:liger.get("queryAttrDesc").getValue()}   					]});   				gridManager.loadData(true);   				dialog.hidden();			}			//新增点击确定按钮			function addOK(item, dialog){				var form = liger.get('targetForm');	            if (form.valid()) {					var param = {						attrName : liger.get("attrName").getValue(),						attrDesc : liger.get("attrDesc").getValue(),						attrType : liger.get("attrType").getValue(),						attrLen : liger.get("attrLen").getValue(),						seqNum : liger.get("seqNum").getValue()					};					$.post("${ctx }/AttrAction.action?method=saveAttrAdd&anticache="							+ Math.floor(Math.random() * 10000), param ,function(info){						if (info.info == undefined) {							info = eval("(" + info + ")");						}						if (info.info == 'ok') {		            		grid.reload();		            		dialog.hidden();						} else {							error_alert("${ctx}","新增属性失败",mapToString(param));						}					});				}else {	                form.showInvalid();	            }			}			//编辑点击确定按钮			function editOK(item, dialog){				var form = liger.get('targetForm');	            if (form.valid()) {					var param ={						attrId : $("#attrId").val(),						attrName : liger.get("attrName").getValue(),						attrDesc : liger.get("attrDesc").getValue(),						attrType : liger.get("attrType").getValue(),						attrLen : liger.get("attrLen").getValue(),						seqNum : liger.get("seqNum").getValue()					};					$.post("${ctx }/AttrAction.action?method=saveAttrEdit&anticache="							+ Math.floor(Math.random() * 10000), param, function(info){						if (info.info == undefined) {							info = eval("(" + info + ")");						}						if (info.info == 'ok') {		            		grid.reload();		            		dialog.hidden();						} else {							error_alert("${ctx}","修改属性失败",mapToString(param));						}					});				}else {	                form.showInvalid();	            }			}	         		</script>	</head>	<body style="overflow-x:hidden; padding:2px;">		<div class="l-loading" style="display:block" id="pageloading"></div>    	<div id="maingrid"></div>    	<!-- 查询框 -->    	<div id="targetQuery" class="self-form" style="display:none;">        	<table class="self-table">    			<tr>    				<td width="90px">属性名称</td>    				<td><input type="text" id="queryAttrName" value=""></td>    			</tr>    			<tr>    				<td width="90px">属性描述</td>    				<td><input type="text" id="queryAttrDesc" value=""></td>    			</tr>    		</table>    	</div>    	<!-- 修改新增框中 -->    	<div id="target" style="display:none;">    		<form id="targetForm" class="self-form">        	<table class="self-table">    			<tr>    				<td width="90px">属性名称</td>    				<td><input type="text" id="attrName" value="" validate="{required:true,maxlength:20}"></td>    			</tr>    			<tr>    				<td width="90px">属性描述</td>    				<td><input type="text" id="attrDesc" value="" validate="{required:true,maxlength:20}"></td>    			</tr>    			<tr>    				<td width="90px">属性类型</td>    				<td>    					<select id="attrType"  validate="{required:true}">							<option value="VARCHAR" selected>文字</option>							<option value="NUMBER">数字</option>						</select>    				</td>    			</tr>    			<tr>    				<td width="90px">属性长度</td>    				<td><input type="text" id="attrLen" ltype="int" value="" validate="{required:true}"></td>    			</tr>    			<tr>    				<td width="90px">显示顺序</td>    				<td><input type="text" id="seqNum" ltype="int" value="" validate="{required:true,maxlength:2}"></td>    			</tr>    		</table>    		</form>    	</div>    	    	<input type="hidden" id="attrId" value="">	</body></html>